ESET Nod32 Update Mirror
=========

Скрипт для обновления зеркала антивируса Eset Nod32 с бесплатных серверов (для обновления с официальных серверов нужнодописать пару строк). Требования:

  - Источник должен выводить листинг (mod_autoindex.c) файлов (wget делает рекурсивную копию всего зеркала, основываваять по ссылкам на файлы как раз из листинга)
  - Сервер на Linux
  - Apache для показа морды и вывода листинга (тестировалось на версии 1.3.42)
  - Наличие и разрешение на запуск 'curl' (проверка состояния источника), 'wget' (скачивание источника), 'rm', 'mkdir', 'mv' и 'find'


Алгоритм работы скрипта следующий:
  1. Запрашиваем файл 'update.ver' по адресу, указанному в массиве источников $bases_urls_array; таким макаром проверяем каждый url
  2. Если файл не найден (HTTP заголовок ответа !== 200), то выходим
  3. Иначе же травим 'wget' на этот url, скачивая всё содержтмое во временную папку
  4. Создаем файл-временную метку и 'robots.txt', запрещающий индексацию
  5. Удаляем мусор, и переносим из временной папки в основную

Код не самый лучший, написан на коленке, но работает.

История изменений
----

* **0.2.5-sh** - PHP версия более не поддерживается, скрипт переписан на bash
* **0.2.5** - Масса мелких исправлений в .htaccess и верстке
* **0.2.4** - Релиз на гитхабе

Оформление внешнего вида
-----------

![alt tag](http://oi60.tinypic.com/14o87lc.jpg)

Используется возможность модуля 'mod_autoindex.c' сервера 'Apache'. Для настройки вывода редактируются 3 файла:

* **.htaccess** - 'IndexOptions' и продие директивы, отвечающие за вывод листинга
* **.header.html** - Верстка _перед_ выодом листинга
* **.footer.html** - Верстка _после_ листинга


Настройки
--------------
* **update_nod32_mirror.sh** - В начале файла секция настроек
* **.htaccess** - Разграничение доступа к зеркалу


**Автоматизация** - Добавьте запуск скрипта в 'cron' с интервалом запуска 2..3 раза в сутки

Ссылки
-----------
[Пост в блоге] об этом хабе

**Make love, not war!**

[Пост в блоге]:http://tmblr.co/ZYW79o1CrHcIG
